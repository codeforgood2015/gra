<!DOCTYPE html>
<html>
  <head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Green My Restaurant</title>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet">
	<link rel='stylesheet' href='/stylesheets/style.css' media="only screen and (min-width: 721px)" />
	<link href="mobile.css" rel="stylesheet" type="text/css" media="only screen and (max-width: 720px)" />

    <script src = "../babylon.js"></script>

    <!-- Custom styles for this template -->
    <link href="../stylesheets/starter-template.css" rel="stylesheet">
  </head>
  <body ng-app="guiApp">

	<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span> 
          </button>
          <a class="navbar-brand" href="/#">Green My Restaurant</a>
        </div>

        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="http://www.dinegreen.org">Resources</a></li>
            <li><a href="/#/login">Login</a></li>
            <li><a href="/#/profile">Profile</a></li>
            <li><a class="link" ng-click="logout()">Logout</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
	<div class="container-fluid">
    <div class="col-md-8 col-sm-8">
      <div id="centerColumn">
				<div class="row">
					<div id="graphicsDiv" class = "btn-group" role = "group" aria-label = "...">
<!--              <div id = "settings" class="btn-group" role="group">
              <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                <span class="glyphicon glyphicon-cog"></span>
                <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu">
                <li><a href="#">View Tutorial</a></li>
                <li><a href="#">Other things</a></li>
                <li><a href="#">Other other things</a></li>
              </ul>
            </div> -->
            <div id = "buttons" class = "btn-group-vertical" role = "group" aria-label="...">
							<button id = "diningRoomButton" type = "button" class = "btn btn-default">Dining Room</button>

							<button id = "restroomButton" type = "button" class = "btn btn-default">Restroom</button>

              <button id = "kitchenButton" type = "button" class = "btn btn-default">Kitchen</button>

              <button id = "storageButton" type = "button" class = "btn btn-default">Storage</button>

              <button id = "utilityButton" type = "button" class = "btn btn-default">Utility</button>

              <button id = "officeButton" type = "button" class = "btn btn-default">Office</button>
            </div>
						<canvas id="renderCanvas"></canvas>
					</div>
				</div>
            </div>
        </div>
		<div class="col-md-4 col-sm-8" style="padding: 1em; position: relative;"> 
			<div class="progress progress-category">
				<div class="progress-bar progress-bar-danger" id="Disposable" role="progressbar" aria-valuenow="{{pointsEarned}}" aria-valuemin="0" aria-valuemax="{{minRequired}}" style="width: 0%"></div>
				<div style="position:absolute; right:0; z-index: 4;">
					<a href="/gui/#/Disposables">Disposables</a>
				</div>
			</div>
			<div class="progress progress-category">
				<div class="progress-bar progress-bar-danger" id="Energy" role="progressbar" aria-valuenow="{{pointsEarned}}" aria-valuemin="0" aria-valuemax="10" style="width: 0%"></div>
				<div style="position:absolute; right:0; z-index: 4;">
					<a href="/gui/#/Energy">Energy</a>
				</div>
			</div>
			<div class="progress progress-category">
				<div class="progress-bar progress-bar-danger" id="Food" role="progressbar" aria-valuenow="{{pointsEarned}}" aria-valuemin="0" aria-valuemax="10" style="width: 0%"></div>
				<div style="position:absolute; right:0; z-index: 4;">
					<a href="/gui/#/Food">Food</a>
				</div>
			</div>
			<div class="progress progress-category">
				<div class="progress-bar progress-bar-danger" id="FandB" role="progressbar" aria-valuenow="{{pointsEarned}}" aria-valuemin="0" aria-valuemax="10" style="width: 0%"></div>
				<div style="position:absolute; right:0; z-index: 4;">
					<a href="/gui/#/Sustainable Furnishings & Building Materials">Furnishings and Building Mat.</a>
				</div>
			</div>
			<div class="progress progress-category">
				<div class="progress-bar progress-bar-danger" id="PollChem" role="progressbar" aria-valuenow="{{pointsEarned}}" aria-valuemin="0" aria-valuemax="10" style="width: 0%"></div>
				<div style="position:absolute; right:0; z-index: 4;">
					<a href="/gui/#/Pollution & Chemical Reduction">Poll. & Chem .Reduction</a>
				</div>
			</div>
			<div class="progress progress-category">
				<div class="progress-bar progress-bar-danger" id="Waste" role="progressbar" aria-valuenow="{{pointsEarned}}" aria-valuemin="0" aria-valuemax="10" style="width: 0%"></div>
				<div style="position:absolute; right:0; z-index: 4;">
					<a href="/gui/#/Waste">Waste</a>
				</div>
			</div>
			<div class="progress progress-category">
				<div class="progress-bar progress-bar-danger" id="Water" role="progressbar" aria-valuenow="{{pointsEarned}}" aria-valuemin="0" aria-valuemax="10" style="width: 0%"></div>
				<div style="position:absolute; right:0; z-index: 4;">
					<a href="/gui/#/Water">Water</a>
				</div>
			</div>
		</div>
		<div ng-view></div>
    </div>

	<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min.js"></script>
	<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular-route.min.js"></script>
	<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular-animate.min.js"></script>
	<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular-cookies.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
	<script src="http://angular-ui.github.io/bootstrap/ui-bootstrap-tpls-0.4.0.js"></script>
	<script src="/javascripts/angularApp/guiApp.js"></script>
	<script src="/javascripts/angularApp/guiController.js"></script>
	<script src="/javascripts/angularApp/categoryController.js"></script>
	<script>
        if (BABYLON.Engine.isSupported()) {
            var canvas = document.getElementById("renderCanvas");
            var engine = new BABYLON.Engine(canvas, true);

            BABYLON.SceneLoader.Load("", "../babylon/DemoRestaurant.babylon", engine, function (newScene) {
                // Wait for textures and shaders to be ready
                // console.log(newScene);
                newScene.executeWhenReady(function () {
                    // Attach camera to canvas inputs
                    newScene.activeCamera.attachControl(canvas);
                    var camera = newScene.activeCamera;
                    var initialCameraPosition = camera.position;
                    var initialCameraRotation = camera.cameraRotation;
                    var initialCameraFOV = camera.fov;
                    // camera.position.z = 5;

                    canvas.addEventListener("click", function(){
                        var pickResult = newScene.pick(newScene.pointerX, newScene.pointerY);
                        console.log('mesh name: ' + pickResult.pickedMesh.name);
                        console.log('cameraInfo: ' + camera.cameraRotation);
                        console.log('cameraPosition: ' + camera.position);
                        // console.log('initialCameraInfo: '+ initialCameraRotation.z);
                      });

                    var updatePosition = function(x,y,z, roomName){
                      camera.position.x = newScene.getMeshByName(roomName).position.x;
                      camera.position.y = 6;
                      camera.position.z = newScene.getMeshByName(roomName).position.z;
                    }

                    $('#diningRoomButton').click(function() {
                      updatePosition(13, 6, 15, "Dining Room");
                    });
                    $('#restroomButton').click(function() {
                      updatePosition(-13, 6, 13, "Restroom");
                    });
                    $('#kitchenButton').click(function(){
                      updatePosition(10, 6, -20, "Kitchen");
                    })
                    $('#officeButton').click(function(){
                      updatePosition(10, 6, -5, "Office");
                    })
                    $('#utilityButton').click(function(){
                      updatePosition(5, 6, 13, "Utility");
                    })
                    $('#storageButton').click(function(){
                      updatePosition(15, 6, 13, "Storage");
                    })
                    // $(document).keydown(function(e){
                    // 	if(e.which === 40){
                    // 		// console.log(camera.fov);
                    // 	}
                    // });

                    // Once the scene is loaded, just register a render loop to render it
                    engine.runRenderLoop(function() {
                        newScene.render();
                    });
                    window.addEventListener("resize", function(){
                     engine.resize();
                    })
                });
            }, function (progress) {
                // To do: give progress feedback to user
            })    ;
        }
    </script>
  </body>
</html>